<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security6">

<!-- 1. HEAD FRAGMENT -->

<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title} + ' - Cổng Dịch vụ công'"></title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,600;1,600&display=swap"
        rel="stylesheet">

    <!-- Core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" th:href="@{/assets/css/style.css}">
    <link rel="stylesheet" th:href="@{/assets/css/portal.css}">

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- SockJS và STOMP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        :root {
            --primary-blue: #0f4c81;
            --primary-dark: #0a355c;
            --accent-gold: #ffd700;
            --accent-red: #d32f2f;
            --text-main: #2c3e50;
            --bg-glass: rgba(255, 255, 255, 0.85);
            --shadow-soft: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-main);
            padding-top: 100px;
            /* Space for fixed navbar */
        }

        /* GLASS NAVBAR */
        .navbar-glass {
            background: linear-gradient(135deg, rgba(15, 76, 129, 0.95), rgba(10, 53, 92, 0.95));
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .navbar-brand {
            font-family: 'Playfair Display', serif;
            letter-spacing: 0.5px;
        }

        /* FOOTER MODERN */
        .footer-modern {
            background: #0f1c2e;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .footer-title {
            color: white;
            font-weight: 700;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 10px;
        }

        .footer-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 40px;
            height: 3px;
            background: var(--accent-gold);
            border-radius: 3px;
        }

        a.hover-link {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all 0.2s;
        }

        a.hover-link:hover {
            color: white;
            padding-left: 5px;
        }

        /* Dropdown modern */
        .dropdown-menu-modern {
            border-radius: 16px;
            padding: 0.5rem;
        }

        .dropdown-menu-modern .dropdown-item {
            border-radius: 8px;
        }

        .dropdown-menu-modern .dropdown-item:hover {
            background: rgba(15, 76, 129, 0.1);
        }
    </style>
</head>

<body>

    <!-- 2. HEADER FRAGMENT -->
    <nav th:fragment="header(activePage)" class="navbar navbar-expand-lg navbar-dark navbar-glass fixed-top py-3">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center fw-bold fs-4" th:href="@{/}">
                <i class="bi bi-bank2 me-3 text-warning"></i>
                <span>DỊCH VỤ CÔNG<br><small class="fs-6 fw-normal opacity-75 d-block">Thành phố Đà Nẵng</small></span>
            </a>
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse"
                data-bs-target="#landingNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="landingNav">
                <ul class="navbar-nav ms-auto align-items-center gap-lg-4">
                    <li class="nav-item">
                        <a class="nav-link fw-medium"
                            th:classappend="${activePage == 'home'} ? 'active fw-bold text-warning' : ''"
                            th:href="@{/}">Trang chủ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium"
                            th:classappend="${activePage == 'hoso'} ? 'active fw-bold text-warning' : ''"
                            th:href="@{/citizen/hoso}">Hồ sơ của tôi</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium"
                            th:classappend="${activePage == 'services'} ? 'active fw-bold text-warning' : ''"
                            th:href="@{/citizen/services}">Dịch vụ công</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium" href="#">Hướng dẫn</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium"
                            th:classappend="${activePage == 'feedback'} ? 'active fw-bold text-warning' : ''"
                            th:href="@{/citizen/feedback}">Phản ánh kiến nghị</a>
                    </li>
                </ul>

                <div class="ms-lg-4">
                    <!-- Nếu chưa đăng nhập -->
                    <div sec:authorize="!isAuthenticated()">
                        <a th:href="@{/}" class="btn btn-outline-light rounded-pill px-4 fw-bold border-2 shadow-sm">
                            <i class="bi bi-person-circle me-2"></i>Đăng nhập
                        </a>
                    </div>

                    <!-- Nếu đã đăng nhập -->
                    <div sec:authorize="isAuthenticated()">
                        <div class="dropdown">
                            <button
                                class="btn btn-outline-light rounded-pill pe-4 ps-2 py-1 dropdown-toggle d-flex align-items-center border-2 border-white border-opacity-25 bg-white bg-opacity-10"
                                id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false" type="button">
                                <img th:src="${'https://ui-avatars.com/api/?name=' + #strings.replace(#authentication.principal.fullName, ' ', '+') + '&size=64&background=random&color=fff'}"
                                    class="rounded-circle me-2" style="width: 32px; height: 32px;" alt="Avatar">
                                <span class="fw-bold text-white" sec:authentication="principal.fullName">User</span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end shadow-lg dropdown-menu-modern border-0 mt-2 p-2"
                                aria-labelledby="userDropdown">
                                <li class="px-3 py-2 border-bottom mb-2 d-md-none">
                                    <div class="fw-bold text-primary small" sec:authentication="principal.fullName">User
                                    </div>
                                    <div class="text-muted smallest" style="font-size: 0.7rem;"
                                        sec:authentication="principal.username">Username</div>
                                </li>
                                <li><a class="dropdown-item rounded-3 py-2" th:href="@{/citizen/profile}"><i
                                            class="bi bi-person-vcard me-2 text-primary"></i>Hồ sơ cá nhân</a></li>
                                <li><a class="dropdown-item rounded-3 py-2" th:href="@{/citizen/hoso}"><i
                                            class="bi bi-file-earmark-text me-2 text-primary"></i>Hồ sơ của tôi</a></li>
                                <li><a class="dropdown-item rounded-3 py-2" th:href="@{/citizen/vault}"><i
                                            class="bi bi-safe2 me-2 text-primary"></i>Kho dữ liệu số</a></li>
                                <li>
                                    <hr class="dropdown-divider opacity-10">
                                </li>
                                <li class="px-2">
                                    <form th:action="@{/logout/citizen}" method="post" class="m-0">
                                        <button type="submit"
                                            class="dropdown-item rounded-3 py-2 text-danger fw-bold w-100 text-start border-0 bg-transparent">
                                            <i class="bi bi-box-arrow-right me-2"></i>Đăng xuất
                                        </button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 3. FOOTER FRAGMENT -->
    <footer th:fragment="footer" class="footer-modern py-5 mt-auto">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-4">
                    <a href="#" class="d-flex align-items-center mb-3 text-decoration-none text-white">
                        <i class="bi bi-bank2 fs-2 me-3 text-white-50"></i>
                        <span class="fw-bold fs-5">TRUNG TÂM HÀNH CHÍNH CÔNG<br>TP. ĐÀ NẴNG</span>
                    </a>
                    <p class="opacity-75 lh-lg">
                        Hệ thống cung cấp thông tin và dịch vụ công trực tuyến.
                        Nơi tiếp nhận, xử lý phản ánh, kiến nghị của tổ chức, cá nhân.
                    </p>
                    <div class="d-flex gap-3 mt-4">
                        <a href="#" class="btn btn-outline-light btn-sm rounded-circle"
                            style="width: 35px; height: 35px;"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="btn btn-outline-light btn-sm rounded-circle"
                            style="width: 35px; height: 35px;"><i class="bi bi-youtube"></i></a>
                        <a href="#" class="btn btn-outline-light btn-sm rounded-circle"
                            style="width: 35px; height: 35px;"><i class="bi bi-globe"></i></a>
                    </div>
                </div>
                <div class="col-lg-2 offset-lg-1">
                    <h6 class="footer-title">LIÊN KẾT</h6>
                    <ul class="list-unstyled d-flex flex-column gap-2">
                        <li><a href="#" class="hover-link">Cổng thông tin</a></li>
                        <li><a href="#" class="hover-link">Văn bản pháp luật</a></li>
                        <li><a href="#" class="hover-link">Thủ tục hành chính</a></li>
                        <li><a href="#" class="hover-link">Dữ liệu mở</a></li>
                    </ul>
                </div>
                <div class="col-lg-2">
                    <h6 class="footer-title">HỖ TRỢ</h6>
                    <ul class="list-unstyled d-flex flex-column gap-2">
                        <li><a href="#" class="hover-link">Câu hỏi thường gặp</a></li>
                        <li><a href="#" class="hover-link">Hướng dẫn sử dụng</a></li>
                        <li><a href="#" class="hover-link">Kiểm tra trạng thái</a></li>
                        <li><a href="#" class="hover-link">Góp ý hệ thống</a></li>
                    </ul>
                </div>
                <div class="col-lg-3">
                    <h6 class="footer-title">LIÊN HỆ</h6>
                    <ul class="list-unstyled d-flex flex-column gap-3">
                        <li class="d-flex"><i class="bi bi-geo-alt text-warning me-3"></i> 24 Trần Phú, Hải Châu, Đà
                            Nẵng</li>
                        <li class="d-flex"><i class="bi bi-telephone text-warning me-3"></i> (0236) 1022</li>
                        <li class="d-flex"><i class="bi bi-envelope text-warning me-3"></i> contact@danang.gov.vn</li>
                    </ul>
                </div>
            </div>
            <div class="border-top border-secondary border-opacity-25 mt-5 pt-4 text-center">
                <p class="mb-0 opacity-50 small">&copy; 2025 E-Gov Simulation System. All rights reserved.</p>
            </div>
        </div>
        <!-- JS Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    </footer>

</body>

</html>